# Fluent Bit parsers configuration for Agentic Startup Studio

[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

[PARSER]
    Name        json
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

[PARSER]
    Name        nginx
    Format      regex
    Regex       ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")?$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name        nginx_error
    Format      regex
    Regex       ^(?<time>\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2}) \[(?<level>\w+)\] (?<pid>\d+).(?<tid>\d+): (?<message>.*)$
    Time_Key    time
    Time_Format %Y/%m/%d %H:%M:%S

[PARSER]
    Name        postgres
    Format      regex
    Regex       ^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}.\d{3} \w+) \[(?<pid>\d+)\] (?<level>\w+):  (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S.%L %Z

[PARSER]
    Name        redis
    Format      regex
    Regex       ^(?<pid>\d+):(?<role>\w+) (?<time>\d{2} \w{3} \d{4} \d{2}:\d{2}:\d{2}.\d{3}) (?<level>.) (?<message>.*)$
    Time_Key    time
    Time_Format %d %b %Y %H:%M:%S.%L

[PARSER]
    Name        python_json
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%fZ
    Time_Keep   On

[PARSER]
    Name        fastapi
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Decode_Field_As escaped_utf8 message

[PARSER]
    Name        crewai
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       task_duration:float agent_id:string crew_id:string

[PARSER]
    Name        uvicorn_access
    Format      regex
    Regex       ^(?<client_ip>[^ ]*) - "(?<method>[^ ]*) (?<path>[^ ]*) HTTP/(?<http_version>[^"]*)" (?<status_code>\d+)$
    Types       status_code:integer

[PARSER]
    Name        security_audit
    Format      json
    Time_Key    event_time
    Time_Format %Y-%m-%dT%H:%M:%S.%fZ
    Time_Keep   On
    Types       user_id:string action:string resource:string ip_address:string

[PARSER]
    Name        model_inference
    Format      json
    Time_Key    inference_time
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       duration_ms:float tokens_processed:integer model_name:string success:boolean

[PARSER]
    Name        agent_task
    Format      json
    Time_Key    task_start_time
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       task_id:string agent_id:string duration_seconds:float success:boolean retry_count:integer

[PARSER]
    Name        database_query
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z) \[(?<level>\w+)\] Query: (?<query>.*) Duration: (?<duration>\d+\.?\d*)ms$
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Types       duration:float

[PARSER]
    Name        cache_access
    Format      json
    Time_Key    access_time
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       hit:boolean key:string ttl_seconds:integer

[PARSER]
    Name        business_metrics
    Format      json
    Time_Key    event_timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       user_id:string event_type:string value:float metadata:json

[PARSER]
    Name        error_tracking
    Format      json
    Time_Key    error_time
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       error_id:string severity:string component:string user_id:string

[PARSER]
    Name        performance_metrics
    Format      json
    Time_Key    measurement_time
    Time_Format %Y-%m-%dT%H:%M:%S.%f
    Time_Keep   On
    Types       metric_name:string value:float unit:string tags:json